# Unity VK Bridge SDK
Данный SDK предназначен для работы с VK Bridge из Unity (WebGL), как на мобильных платформах (для игр в приложении Вконтакте или на m.vk.com), так и для десктопных iFrame приложений в каталоге игр вконтакте.

# Установка
Просто скопируйте содержимое **Assets** в ваш проект, либо импортируйте архив **.unitypackage**. В проекте также есть пример работы.
Для того, чтобы скрипт правильно работал - изучите шаблон **VKBridge** и подключите его в качестве основного в настройках проекта в окне **"Build Settings > Player Settings > Resolution and Presentation"**.

Либо скопируйте и подключите файл **"bridge-wrapper.js"** из папки **"WebGL Templates > VKBridge > Template Data"** в ваш шаблон.

# Начало работы
Для подключения к VK Bridge используйте следующую конструкцию:
```csharp
// Настройка VK Bridge
Bridge.Setup(new BridgeConfigs() {
  AppID = 111111,               // ID Приложения вконтакте
  APIVer = "5.132",             // Версия API Вконтакте
  DebugMode = true,             // Режим отладки
  Scopes = "friends,wall"       // Разрешения, которые нужны для выполнения запросов к API вконтакте
});

// Подключение к VK Bridge
Bridge.Connect();
```

Настройки библиотеки Bridge включат в себя:

| Параметр       | Тип                | Назначение |
| ------------- |:------------------:| :-----|
| AppID     | int | ID Приложения вконтакте |
| APIVer     | string | Версия API вконтакте. По-умолчанию **"5.132"** |
| DebugMode  | bool | Режим отладки. По-умолчанию **false** |
| Scopes | string | Разрешения, запрашиваемые при запуске приложения, перечисленные через запятую. По-умолчанию **"friends,wall"** |

# Подписка на события
Для того, чтобы прослушивать события получаемые от VK Bridge, необходимо подписаться на них:
```csharp
Bridge.AddEventHandler("VKWebAppGetUserInfoResult", (data) => {
  /* Вызывается после события */
});
```

Также не забывайте отписываться от событий, когда это нужно:
```csharp
// Отписка от события, где callback - ссылка на метод, вызываемый при событии
Bridge.RemoveEventHandler("VKWebAppGetUserInfoResult", callback);
```

Список событий, на которые можно подписаться, вы можете найти в документации вконтакте:<br/>
https://vk.com/dev/vkbridge?f=Игры

# Viewer ID и Auth Key
Для того, чтобы найти эти параметры, важные для авторизации на стороне сервера, используйте подписку на событие "VKWebAppGetUserInfoResult".
Оно, помимо стандартных параметров, возвращаемых от VK, также содержит дополнительные параметры, такие как:

| Параметр       | Тип                | Назначение |
| ------------- |:------------------:| :-----|
| viewer_id     | string | ID пользователя вконтакте |
| auth_key     | string | Ключ авторизации пользователя |
| platform | string | Платформа, используемая Bridge |

# Вызов методов вконтакте
После того, как вы инициализировали VK Bridge, вы можете создавать вызовы к API:
```csharp
// Вызов метода VK API, где paramObject - это объект с параметрами API метода
Bridge.Call("friends.get", paramObject, (data) => {
  /* Коллбек, полученный от сервера, где data - сериализованный JSON-объект в виде string
});
```

# Платежи
Для совершения платежей в VK Bridge, вы должны вызвать платежное окно при помощи:
```csharp

```

# Реклама
Для вызова рекламы, вы должны обратиться к методу:
```csharp

```

Реклама будет вызываться через Adman на ПК или m.vk.com, в приложении вконтакте будет вызываться нативное рекламное окно.
Подробнее о рекламе можно прочитать в документации вконтакте:<br/>
https://vk.com/dev/vkbridge/vkwebappshownativeads

# Другие функции VK Bridge
Для вызова других методов VK Bridge мы подготовили нативные вызовы в библиотеке. К примеру:
```csharp

```

Полный список методов VK Bridge в библиотеке:

| Метод | Назначение |
| ------------- | ------------- |
